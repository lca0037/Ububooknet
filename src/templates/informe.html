<!DOCTYPE html>
<html lang="{{ _('es') }}">
<head>
	<title>Ububooknet</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
	<header id="header">
		<div class="logo">
			<h1>Ububooknet</h1>
		</div>
		<div class="region"> 
			<h2>{{ _('Informe') }}</h2>
		</div>
		<div class="menu">
			<ul>
				<li><a href="{{ url_for('index') }}">{{ _('Inicio') }}</a></li>
				<li><a href="https://github.com/lca0037/GII18.0U-Ububooknet">{{ _('Repositorio') }}</a></li>
			</ul>
		</div>
		<div class="banderas">
			<img src="{{ url_for('static', filename='img/esp.png') }}" id="esp" onclick="idioma('es','{{ g.locale }}')">
			<img src="{{ url_for('static', filename='img/uk.png') }}" id="uk" onclick="idioma('en','{{ g.locale }}')">
		</div>
	</header>
	<div id="workflow">
		<div class="txt-work">
			<a href="{{ url_for('index') }}">{{ _('CARGAR EPUB') }}</a> > <a href="{{ url_for('dictaut') }}">{{ _('DICCIONARIO de PERSONAJES') }}</a> > <a href="{{ url_for('moddict') }}">{{ _('MODIFICAR DICCIONARIO') }}</a> > <a href="{{ url_for('params') }}">{{ _('PARÁMETROS ADICIONALES') }}</a> > <a href="{{ url_for('red') }}">{{ _('RED') }}</a> > <a href="#">{{ _('INFORME') }}</a>
		</div>
	</div>
	<div id="loading"></div>
	<div id="content">
		<div id="indice">
			<div id="form-mov">
				<input type="button" name="btn btn-volver" onclick="window.location.href='{{ url_for('red') }}'" value="{{ _('Volver') }}">
				<input type="button" onclick="sendForm()" name="btn btn-informe" value="{{ _('Generar Informe') }}">
			</div>
		</div>
		<div id="forms">
			<div id="form-content">
				<form id="form" action="" method="post" enctype=multipart/form-data>
					<h3>{{ _('Medidas básicas') }}</h3>
					<input type="checkbox" id="cbx-nnod" name="cbx cbx-nnod">
					<label for="cbx-nnod">{{ _('Obtener Número Nodos') }}</label>
					<br/>
					<input type="checkbox" id="cbx-nenl" name="cbx cbx-nenl">
					<label for="cbx-nenl">{{ _('Obtener Número Enlaces') }}</label>
					<br/>
					<input type="checkbox" id="cbx-nint" name="cbx cbx-nint">
					<label for="cbx-nint">{{ _('Obtener Número Interacciones') }}</label>
					<br/>
					<br/>
					<h3>{{ _('Medidas de grado') }}</h3>
					<input type="checkbox" id="cbx-gradosin" name="cbx cbx-gradosin">
					<label for="cbx-gradosin">{{ _('Obtener Grado Sin Peso') }}</label>
					<br/>
					<input type="checkbox" id="cbx-gradocon" name="cbx cbx-gradocon">
					<label for="cbx-gradocon">{{ _('Obtener Grado Con Peso') }}</label>
					<br/>
					<input type="checkbox" id="cbx-distsin" name="cbx cbx-distsin">
					<label for="cbx-distsin">{{ _('Obtener Distribución Sin Peso') }}</label>
					<br/>
					<input type="checkbox" id="cbx-distcon" name="cbx cbx-distcon">
					<label for="cbx-distcon">{{ _('Obtener Distribución Con Peso') }}</label>
					<br/>
					<input type="checkbox" id="cbx-dens" name="cbx cbx-dens">
					<label for="cbx-dens">{{ _('Obtener Densidad') }}</label>
					<br/>
					<br/>
					<h3>{{ _('Medidas de Distancia') }}</h3>
					<input type="checkbox" id="cbx-concomp" name="cbx cbx-concomp">
					<label for="cbx-concomp">{{ _('Obtener Componentes Conectados') }}</label>
					<br/>
					<input type="checkbox" id="cbx-exc" name="cbx cbx-exc">
					<label for="cbx-exc">{{ _('Obtener Excentricidad') }}</label>
					<br/>
					<input type="checkbox" id="cbx-dia" name="cbx cbx-dia">
					<label for="cbx-dia">{{ _('Obtener Diámetro') }}</label>
					<br/>
					<input type="checkbox" id="cbx-rad" name="cbx cbx-rad">
					<label for="cbx-rad">{{ _('Obtener Radio') }}</label>
					<br/>
					<input type="checkbox" id="cbx-longmed" name="cbx cbx-longmed">
					<label for="cbx-longmed">{{ _('Obtener Distancia Media') }}</label>
					<br/>
					<br/>
					<h3>{{ _('Medidas de Clustering') }}</h3>
					<input type="checkbox" id="cbx-locclust" name="cbx cbx-locclust">
					<label for="cbx-locclust">{{ _('Obtener Coeficiente de Clustering Local') }}</label>
					<br/>
					<input type="checkbox" id="cbx-clust" name="cbx cbx-clust">
					<label for="cbx-clust">{{ _('Obtener Coeficiente de Clustering Local Medio') }}</label>
					<br/>
					<input type="checkbox" id="cbx-trans" name="cbx cbx-trans">
					<label for="cbx-trans">{{ _('Obtener Transitividad') }}</label>
					<br/>
					<br/>
					<h3>{{ _('Medidas de Centralidad') }}</h3>
					<input type="checkbox" id="cbx-centg" name="cbx cbx-centg">
					<label for="cbx-centg">{{ _('Obtener Centralidad de Grado') }}</label>
					<br/>
					<input type="checkbox" id="cbx-centc" name="cbx cbx-centc">
					<label for="cbx-centc">{{ _('Obtener Centralidad de Cercanía') }}</label>
					<br/>
					<input type="checkbox" id="cbx-centi" name="cbx cbx-centi">
					<label for="cbx-centi">{{ _('Obtener Centralidad de Intermediación') }}</label>
					<br/>
					<input type="checkbox" id="cbx-ranwal" name="cbx cbx-ranwal">
					<label for="cbx-ranwal">{{ _('Obtener Intermediación de Camino Aleatorio') }}</label>
					<br/>
					<input type="checkbox" id="cbx-centv" name="cbx cbx-centv">
					<label for="cbx-centv">{{ _('Obtener Centralidad de Valor Propio') }}</label>
					<br/>
					<input type="checkbox" id="cbx-para" name="cbx cbx-para">
					<label for="cbx-para">{{ _('Obtener Pagerank') }}</label>
					<br/>
					<br/>
					<h3>{{ _('Grupos y comunidades') }}</h3>
					<input type="checkbox" id="cbx-kcliperc" name="cbx cbx-kcliperc">
					<label for="cbx-kcliperc">{{ _('Obtener K-clique comunidades') }}</label>
					<br/>
					{{ _('Valor k del K-clique para comunidades') }}: 
					<input type="number" min=2 name="valkcliqper" id="valkcliqper">
					<br/>
					<input type="checkbox" id="cbx-girnew" name="cbx cbx-girnew">
					<label for="cbx-girnew">{{ _('Obtener Girvan-Newman') }}</label>
					<br/>
					<br/>
					<h3>{{ _('Detección de roles') }}</h3>
					<input type="checkbox" id="cbx-roles" name="cbx cbx-roles">
					<label for="cbx-roles">{{ _('Detectar Roles') }}</label>
					<br/>
				</form>
			</div>
		</div>
	</div>
	<footer></footer>
	<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script src="{{ url_for('static', filename='js/language.js') }}" type="text/javascript"></script>
	<script type="text/javascript">
		
		function sendForm() {
			var msg = "{{ _('Por favor introduzca un valor') }}"
			var send = true
			if(document.getElementById("cbx-kcliperc").checked && document.getElementById("valkcliqper").value.length == 0){
				send = false
				msg += "\n" + "{{_('K del K-clique de comunidades')}}"
			}
			if(document.getElementById("cbx-kcliperc").checked && document.getElementById("valkcliqper").value < 2){
				send = false
				msg += "\n" + "{{_('K del K-clique de comunidades mayor o igual que 2')}}"
			}
			if(send){
				alert("{{ _('Esto puede tardar unos minutos.') }}");
        		$("#loading").show();
            	$("#content").hide();
            	$("#workflow").hide();
            	$(".banderas").hide();
				document.getElementById("form").submit()

			} else {
				alert(msg)
			}
		}

		//https://eureka.ykyuen.info/2011/02/22/jquery-javascript-capture-the-browser-or-tab-closed-event/
		var validNavigation = false;

		function endSession() {
			$.ajax({
		      type: "POST",
		      contentType: "application/json;charset=utf-8",
		      url: "/Fin-Sesion",
		      traditional: "true",
		      data: JSON.stringify({{ g.usuario }}),
		      dataType: "json",
		      success: function(response){
          			location.reload();
         		 }
		    });
		}
		 
		function wireUpEvents() {
		  /*
		  * For a list of events that triggers onbeforeunload on IE
		  * check http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx
		  */
		  window.onbeforeunload = function(event) {
		  	//console.log(event)
		  	console.log('before',validNavigation)
		      if (!validNavigation) {
		         endSession();
		      }
		  }
		 
		  // Attach the event keypress to exclude the F5 refresh
		  $(document).bind('keydown', function(e) {
		    if (e.keyCode == 116){
		      validNavigation = true;
		    }
		  });
		 
		  // Attach the event click for all links in the page
		  $("a").bind("click", function() {
		    validNavigation = true;
		  });
		 
		  // Attach the event submit for all forms in the page
		  $("form").bind("submit", function() {
		    validNavigation = true;
		  });
		 
		  // Attach the event click for all inputs in the page
		  $("input[type=submit]").bind("click", function() {
		    validNavigation = true;
		  });

		  $("input[type=button]").bind("click", function() {
		    validNavigation = true;
	  	  });
		}
		 
		// Wire up the events as soon as the DOM tree is ready
		$(document).ready(function() {
		  wireUpEvents();  
		});
	</script>
</body>
</html>